{% extends 'base.html' %}
{% block content %}
{% load crispy_forms_tags %}


{# SECTION: Main Comment Container #}
<div class="row">
    {# SECTION: Comment List (8 cols) #}
    <div class="col-md-8 card mb-4 mt-3">
        <h3>Comments:</h3>
        <div class="card-body">
            {# Loop: Render Individual Comments #}
            {% for comment in comments %}
            <div class="comments" style="padding: 10px;">
                {# Comment Metadata #}
                <p class="font-weight-bold">
                    {{ comment.user.username }}
                    <span class="text-muted font-weight-normal">
                        {{ comment.created_on }}
                    </span> wrote:
                </p>
                {# Comment Content #}
                {{ comment.body | linebreaks }}
            </div>
            {% endfor %}
        </div>
    </div>

    {# SECTION: Sidebar Content (4 cols) #}
    <div class="col-md-4 card mb-4 mt-3">
        <div class="card-body">
            {# === Comment Status Management === #}
            {% if commented %}
            {# Success Message for Pending Comments #}
            <div class="alert alert-success" role="alert">
                Your comment is awaiting approval
            </div>
            {% else %}
            {# === Authentication Check === #}
            {% if user.is_authenticated %}
            <h3>Leave a comment:</h3>
            <p>Posting as: {{ user.username }}</p>
            {# === Comment Form Implementation === #}
            <form method="post" style="margin-top: 1.3em;">
                {# Render Form with Crispy Styling #}
                {{ comment_form | crispy }}
                {# Security Token #}
                {% csrf_token %}
                {# Submit Button #}
                <button type="submit"
                    class="btn btn-signup btn-lg">Submit</button>
            </form>
            {% endif %}
            {% endif %}
        </div>
    </div>
</div>
{% endblock content %}